# Default inputs.conf file
# Managed through Puppet
# Copyright (C) 2009-2012 Splunk Inc. All Rights Reserved.
[default]
host = <%= @fqdn %>

[script://./bin/vmstat.sh]
index = <%= @index %>
disabled = 0

[script://./bin/iostat.sh]
index = <%= @index %>
disabled = 1

[script://./bin/ps.sh]
index = <%= @index %>
disabled = 1

[script://./bin/top.sh]
index = <%= @index %>
disabled = 0

[script://./bin/netstat.sh]
index = <%= @index %>
disabled = 0

[script://./bin/protocol.sh]
index = <%= @index %>
disabled = 0

[script://./bin/openPorts.sh]
index = <%= @index %>
disabled = 0

[script://./bin/time.sh]
index = <%= @index %>
disabled = 0

[script://./bin/lsof.sh]
index = <%= @index %>
disabled = 1

[script://./bin/df.sh]
index = <%= @index %>
disabled = 0

# Shows current user sessions
[script://./bin/who.sh]
index = <%= @index %>
disabled = 0

# Lists users who could login (i.e., they are assigned a login shell)
[script://./bin/usersWithLoginPrivs.sh]
index = <%= @index %>
disabled = 0

# Shows last login time for users who have ever logged in
[script://./bin/lastlog.sh]
index = <%= @index %>
disabled = 0

# Shows stats per link-level Etherner interface (simply, NIC)
[script://./bin/interfaces.sh]
index = <%= @index %>
disabled = 0

# Shows stats per CPU (useful for SMP machines)
[script://./bin/cpu.sh]
index = <%= @index %>
disabled = 0

# This script reads the auditd logs translated with ausearch
[script://./bin/rlog.sh]
index = <%= @index %>
disabled = 0

# Run package management tool collect installed packages
[script://./bin/package.sh]
index = <%= @index %>
disabled = 0

[script://./bin/hardware.sh]
index = <%= @index %>
disabled = 0

[monitor:///Library/Logs]
index = <%= @index %>
disabled = 0

[monitor:///var/log]
index = <%= @index %>
disabled = 0

[monitor:///var/adm]
index = <%= @index %>
disabled = 0

[monitor:///etc]
blacklist = (puppet|puppet/environments/...|puppet/hieradata|puppet/manifests|puppet/modules|puppet/files)
index = <%= @index %>
disabled = 0

### bash history
[monitor:///root/.bash_history]
disabled = true
index = <%= @index %>

[monitor:///home/.../.bash_history]
disabled = true
index = <%= @index %>



##### Added for ES support
# Note that because the UNIX app uses a single script to retrieve information
# from multiple OS flavors, and is intended to run on Universal Forwarders,
# it is not possible to differentiate between OS flavors by assigning
# different sourcetypes for each OS flavor (e.g. Linux:SSHDConfig), as was
# the practice in the older deployment-apps included with ES. Instead, 
# sourcetypes are prefixed with the generic "Unix".

# May require Splunk forwarder to run as root on some platforms.
[script://./bin/openPortsEnhanced.sh]
disabled = true
index = <%= @index %>

[script://./bin/passwd.sh]
disabled = true
index = <%= @index %>

# Only applicable to Linux
[script://./bin/selinuxChecker.sh]
disabled = true
index = <%= @index %>

# Currently only supports SunOS, Linux, OSX.
# May require Splunk forwarder to run as root on some platforms.
[script://./bin/service.sh]
disabled = true
index = <%= @index %>

# Currently only supports SunOS, Linux, OSX.
# May require Splunk forwarder to run as root on some platforms.
[script://./bin/sshdChecker.sh]
disabled = true
index = <%= @index %>

# Currently only supports Linux, OSX.
# May require Splunk forwarder to run as root on some platforms.
[script://./bin/update.sh]
disabled = true
index = <%= @index %>

[script://./bin/uptime.sh]
disabled = true
index = <%= @index %>

[script://./bin/version.sh]
disabled = true
index = <%= @index %>

# This script may need to be modified to point to the VSFTPD configuration file.
[script://./bin/vsftpdChecker.sh]
disabled = true
index = <%= @index %>
